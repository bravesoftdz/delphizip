<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=UTF-8">
        <title>
            Delete method
        </title>
        <link rel="stylesheet" type="text/css" href="zmhelp.css">
        <meta name="keywords" content="Delete;Delete,TZipMaster;TZipMaster,Delete;">
        <meta name="revised" content="2012-01-15">
        <meta name="copyright" content="Copyright &#169; DelphiZip 2009,2010,2011,2012">
        <meta name="author" content="Russell Peters">
    </head>
    <body>
        <div class="heading">
            <ul class="nav-links">
                <li><a href="cnt.htm" target="cnt">Contents</a></li>
                <li><a href="idx.htm" target="cnt">Index</a></li>
                <li><a href="deflate.htm">Previous</a></li>
                <li><a href="erasefile.htm">Next</a></li>
            </ul>
            <h1>
                Delete method
            </h1>
            <ul class="also-links">
                <li><a href="working_with_sfx.htm">Working with SFX</a></li>
                <li><a href="uf_qualifiedname.htm">QualifiedName</a></li>
                <li><a href="uf_splitqualifiedname.htm">SplitQualifiedName</a></li>
            </ul>
        </div>
        <div class="content">
            <dl class="f">
                <dt class="ft">Applies to</dt>
                <dd class="fd">
                    <p class="f-applies"><a href="tzipmaster_component.htm">TZipMaster</a> component</p>
                </dd>
                <dt class="ft">Declaration</dt>
                <dd class="fd">
                    <p class="f-decl">
                        <b>function</b> Delete: Integer;
                    </p>
					<dl class="f">
						<dt class="ft">Results</dt>
						<dd class="fd">
							<ul class="ul-left">
								<li>Returns 0 on success otherwise a negative value equal to - <a href="errors_and_messages.htm">Error Code</a>.</li>
								<li>Sets <a href="errcode_property.htm">ErrCode</a> and <a href="errmessage_property.htm">ErrMessage</a></li>
							</ul>
						</dd>
					</dl>
                </dd>
                <dt class="ft">Description</dt>
                <dd class="fd">
                    <p class="f-p">
                        Deletes <a href="selecting_files.htm">selected</a> files from the archive specified by the <a href="zipfilename_property.htm">ZipFileName</a> property.
                    </p>
                    <p class="f-p">
						Alternatively you can leave the <a href="zipfilename_property.htm">ZipFileName</a> property empty and use a list of zips and files to be deleted from those zips.
                    </p>
                    <p class="f-p">
						The zips and files have to specified in the <a href="fspecargs_property.htm">FSpecArgs</a> and <a href="fspecargsexcl_property.htm">FSpecArgsExcl</a> properties.
                    </p>
                    <p class="f-p">
						The syntax for specifying zips and files can be found in <a href="filespec_switches.htm">Filespec Switches</a>.
					</p>
                </dd>
                <dt class="ft">Example</dt>
                <dd class="fd"> 
<!-- Highlighted Pascal code generated by DelphiDabbler PasHi -->
<pre class="pas-source"> <span class="pas-comment">// Example using ZipFileName</span>
<span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">ZipFileName</span> <span class="pas-sym">:=</span> <span class="pas-str">'test1_1_7.zip'</span><span class="pas-sym">;</span>
<span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">FSpecArgs</span><span class="pas-sym">.</span><span class="pas-ident">Add</span><span class="pas-sym">(</span><span class="pas-str">'TestZipReference/Sources/afd/*.*'</span><span class="pas-sym">)</span><span class="pas-sym">;</span>    &#9;
<span class="pas-ident">Result</span> <span class="pas-sym">:=</span> <span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">Delete</span><span class="pas-sym">(</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-kwd">if</span><span class="pas-sym">(</span><span class="pas-ident">Result</span><span class="pas-sym">)</span> <span class="pas-kwd">then</span>
  <span class="pas-ident">Handle_error</span><span class="pas-sym">(</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-comment">// Example using list</span>
<span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">ZipFileName</span> <span class="pas-sym">:=</span> <span class="pas-str">''</span><span class="pas-sym">;</span> <span class="pas-comment">// Has to be empty</span>
<span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">FSpecArgs</span><span class="pas-sym">.</span><span class="pas-ident">Add</span><span class="pas-sym">(</span><span class="pas-str">'MergeTest_B.zip&gt;&gt;*.dat'</span><span class="pas-sym">)</span><span class="pas-sym">;</span> <span class="pas-comment">// *.dat from mergetest_B</span>
<span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">FSpecArgs</span><span class="pas-sym">.</span><span class="pas-ident">Add</span><span class="pas-sym">(</span><span class="pas-str">'&gt;&gt;*.dll'</span><span class="pas-sym">)</span><span class="pas-sym">;</span> <span class="pas-comment">// *.dll also from mergetest_B</span>
<span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">FSpecArgsExcl</span><span class="pas-sym">.</span><span class="pas-ident">Add</span><span class="pas-sym">(</span><span class="pas-str">'TestZipReference/Sources/Onroe10.dll'</span><span class="pas-sym">)</span><span class="pas-sym">;</span> <span class="pas-comment">//exclude 1 file&#9;</span>
<span class="pas-ident">Result</span> <span class="pas-sym">=</span> <span class="pas-ident">Zip</span><span class="pas-sym">.</span><span class="pas-ident">Delete</span><span class="pas-sym">(</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
<span class="pas-kwd">if</span><span class="pas-sym">(</span><span class="pas-ident">Result</span><span class="pas-sym">)</span> <span class="pas-kwd">then</span>
  <span class="pas-ident">Handle_error</span><span class="pas-sym">(</span><span class="pas-sym">)</span><span class="pas-sym">;</span></pre>

                </dd>
            </dl>
        </div>
        <div class="foot">2012-01-15 10:18</div>
    </body>
</html>