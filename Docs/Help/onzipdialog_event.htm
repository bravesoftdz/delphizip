<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <meta http-equiv="content-type" content="text/html;charset=UTF-8">
        <title>
            OnZipDialog event
        </title>
        <link rel="stylesheet" type="text/css" href="zmhelp.css">
        <meta name="keywords" content="OnZipDialog;OnZipDialog,TZipMaster;TZipMaster,OnZipDialog;">
        <meta name="revised" content="2012-01-24">
        <meta name="copyright" content="Copyright &#169; DelphiZip 2009,2010,2011,2012">
        <meta name="author" content="Russell Peters">
    </head>
    <body>
        <div class="heading">
            <ul class="nav-links">
                <li><a href="cnt.htm" target="cnt">Contents</a></li>
                <li><a href="idx.htm" target="cnt">Index</a></li>
                <li><a href="ontick_event.htm">Previous</a></li>
                <li><a href="tzipmaster_component.htm#events">Next</a></li>
            </ul>
            <h1>
                OnZipDialog event
            </h1>
        </div>
        <div class="content">
            <dl class="f">
                <dt class="ft">Applies to</dt>
                <dd class="fd">
                    <p class="f-applies"><a href="tzipmaster_component.htm">TZipMaster</a> component</p>
                </dd>
                <dt class="ft">Declaration</dt>
                <dd class="fd">
                    <p class="f-decl">
                        <b>property</b> OnZipDialog: <a href="#tzmdialogevent">TZMDialogEvent</a>;
                    </p>
                    <p class="f-decl">
                        <b>Type</b><br>&nbsp; <a name="tzmdialogevent">TZMDialogEvent</a> = <b>procedure</b>(Sender: TObject; <b>const</b> title: String;
                        <b>var</b> msg: String; <b>var</b> Result: Integer; btns: TMsgDlgButtons) <b>of object</b>;
                    </p> 
					<dl class="f">					
						<dt class="f-args">Arguments</dt>
						<dd class="fd">
							<dl class="tight">
								<dt class="ft-decl">Sender: TObject</dt>
								<dd>The component</dd>
								<dt class="ft-decl">const title: String</dt>
								<dd>Desired Caption</dd>
								<dt class="ft-decl">var msg: String</dt>
								<dd>
									<table>
										<tr>
											<th>IN</th> <td>The message to display</td> 
										</tr>
										<tr>
											<th>OUT</th> <td>(zmtPassword only) password</td>
										</tr>
									</table>
								</dd>
								<dt class="ft-decl">var Result: Integer</dt>                        
								<dd>
									<table>
										<tr>
											<th>IN</th> <td>HighWord=message dialog type (see below)<br>LowWord=<a href="dialog_context.htm">Help context</a></td> 
										</tr>
										<tr>
											<th>OUT</th> <td>ModalResult (unchanged if not handled)</td>
										</tr>
									</table>
								</dd>
								<dt class="ft-decl">btns: TMsgDlgButtons</dt>
								<dd>Required buttons</dd>
							</dl>
						</dd> 
						<dd class="fd">
						<p class="f-decl">
							Defined in ZMDlg.pas
						</p>
						<p class="f-decl">
							// High word = $10 or TMsgDlgType, low word = context (in ZMCtx.pas)
						</p>
						<div class="mono">
							<p class="tight">
								<b>const</b>
							</p>
							<table class="tight" summary="TMsgDlgType constants">
								<tr>
								  <td>zmtWarning</td><td>= $100000;</td>
								</tr>
								<tr>
								  <td>zmtError</td><td>= $110000;</td>
								</tr>
								<tr>
								  <td>zmtInformation</td><td>= $120000;</td>
								</tr>
								<tr>
								  <td>zmtConfirmation</td><td>= $130000;</td>
								</tr>
								<tr>
								  <td>zmtPassword</td><td>= $140000;</td>
								</tr>
							</table>
						</div>
					</dl>
                </dd>
                <dt class="ft">Description</dt>
                <dd class="fd">
                    <p class="f-p">
                        Called before displaying message dialogs to allow custom handling of messages
                    </p>
                </dd>
              <dt class="ft">Example</dt>
                <dd class="fd">
<!-- Highlighted Pascal code generated by DelphiDabbler PasHi -->
<pre class="pas-source"> <span class="pas-comment"> {This handler expects a class TPasswordDlg, 
  capable of displaying the message, the required buttons 
  and having a TEdit to enter the required passwords}</span>

 <span class="pas-kwd">procedure</span> <span class="pas-ident">TMainForm</span><span class="pas-sym">.</span><span class="pas-ident">ZipBuilderZipDialog</span><span class="pas-sym">(</span><span class="pas-ident">Sender</span><span class="pas-sym">:</span> <span class="pas-ident">TObject</span><span class="pas-sym">;</span>
                            <span class="pas-kwd">const</span> <span class="pas-ident">Title</span><span class="pas-sym">:</span> <span class="pas-kwd">String</span><span class="pas-sym">;</span> <span class="pas-kwd">var</span> <span class="pas-ident">msg</span><span class="pas-sym">:</span> <span class="pas-kwd">String</span><span class="pas-sym">;</span>        
                            <span class="pas-kwd">var</span> <span class="pas-ident">Context</span><span class="pas-sym">:</span> <span class="pas-ident">Integer</span><span class="pas-sym">;</span> <span class="pas-ident">Btns</span><span class="pas-sym">:</span> <span class="pas-ident">TMsgDlgButtons</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
  <span class="pas-kwd">var</span>
    <span class="pas-ident">ctx</span><span class="pas-sym">:</span> <span class="pas-ident">Integer</span><span class="pas-sym">;</span>
 <span class="pas-kwd">begin</span>
   <span class="pas-ident">ctx</span> <span class="pas-sym">:=</span> <span class="pas-ident">Context</span> <span class="pas-kwd">and</span> <span class="pas-hex">$FFFF</span><span class="pas-sym">;</span> 
  <span class="pas-kwd">String</span> <span class="pas-ident">MyTitle</span> <span class="pas-sym">:=</span> <span class="pas-ident">Title</span><span class="pas-sym">;</span>
    <span class="pas-kwd">if</span> <span class="pas-sym">(</span><span class="pas-ident">ctx</span> <span class="pas-sym">=</span> <span class="pas-ident">DHC_AddPwrd1</span><span class="pas-sym">)</span> <span class="pas-kwd">or</span> <span class="pas-sym">(</span><span class="pas-ident">ctx</span> <span class="pas-sym">=</span> <span class="pas-ident">DHC_AddPwrd2</span><span class="pas-sym">)</span> <span class="pas-kwd">then</span>
              <span class="pas-comment">// values declared in ZMCtx.pas</span>
     <span class="pas-ident">MyTitle</span> <span class="pas-sym">:=</span> <span class="pas-str">'My Password dialog'</span><span class="pas-sym">;</span>
   <span class="pas-ident">TPasswordDlg</span> <span class="pas-ident">Pdlg</span> <span class="pas-sym">:=</span> <span class="pas-ident">TPasswordDlg</span><span class="pas-sym">.</span><span class="pas-ident">create</span><span class="pas-sym">(</span><span class="pas-ident">this</span><span class="pas-sym">,</span> <span class="pas-num">0</span><span class="pas-sym">,</span> <span class="pas-ident">Btns</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
   <span class="pas-kwd">try</span>
       <span class="pas-ident">msg</span> <span class="pas-sym">:=</span> <span class="pas-ident">Pdlg</span><span class="pas-sym">.</span><span class="pas-ident">ShowModalPwdDlg</span><span class="pas-sym">(</span><span class="pas-ident">MyTitle</span><span class="pas-sym">,</span> <span class="pas-ident">msg</span><span class="pas-sym">)</span><span class="pas-sym">;</span>
       <span class="pas-ident">Context</span> <span class="pas-sym">:=</span> <span class="pas-ident">Pdlg</span><span class="pas-sym">.</span><span class="pas-ident">ModalResult</span><span class="pas-sym">;</span>
   <span class="pas-kwd">finally</span>
       <span class="pas-ident">Pdlg</span><span class="pas-sym">.</span><span class="pas-ident">Free</span><span class="pas-sym">;</span>
   <span class="pas-kwd">end</span><span class="pas-sym">;</span>
 <span class="pas-kwd">end</span><span class="pas-sym">;</span></pre>
                </dd>
            </dl>
        </div>
        <div class="foot">2012-01-24 10:10</div>
    </body>
</html>